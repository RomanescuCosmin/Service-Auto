<!DOCTYPE html>
<html lang="ro" th:replace="~{fragments/layout :: layout(~{::title}, ~{::section})}"
      xmlns:x-transition="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <title>Programările mele</title>
</head>

<body class="bg-slate-50">
<section x-data="{ showContent:false }"
         x-init="setTimeout(()=>showContent=true,120)"
         class="relative min-h-screen bg-slate-50">


    <div x-show="showContent"
         x-transition:enter="transition ease-out duration-700"
         x-transition:enter-start="opacity-0 translate-y-3"
         x-transition:enter-end="opacity-100 translate-y-0"
         class="relative">

        <header class="w-full px-4 sm:px-6 lg:px-10 pt-8">
            <div class="bg-white">

                <div class="px-6 py-5 border-b border-slate-200">
                    <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">

                        <div class="min-w-0">
                            <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">
                                Programările mele
                            </p>

                            <h1 class="mt-1 text-xl font-semibold text-slate-900">
                                Panou client · Service Auto
                            </h1>

                            <p class="mt-1 text-sm text-slate-600">
                                Urmărește programările, statusul și documentele.
                            </p>

                            <div class="mt-3 flex flex-wrap gap-2">
                        <span class="inline-flex items-center gap-1.5 rounded-full
                                     bg-emerald-100 text-emerald-800 border border-emerald-300
                                     px-2.5 py-1 text-xs font-semibold">
                            <span class="h-1.5 w-1.5 rounded-full bg-emerald-600"></span>
                            Confirmată
                        </span>

                                <span class="inline-flex items-center gap-1.5 rounded-full
                                     bg-amber-100 text-amber-900 border border-amber-300
                                     px-2.5 py-1 text-xs font-semibold">
                            <span class="h-1.5 w-1.5 rounded-full bg-amber-600"></span>
                            În așteptare
                        </span>

                                <span class="inline-flex items-center gap-1.5 rounded-full
                                     bg-rose-100 text-rose-800 border border-rose-300
                                     px-2.5 py-1 text-xs font-semibold">
                            <span class="h-1.5 w-1.5 rounded-full bg-rose-600"></span>
                            Anulată
                        </span>
                            </div>
                        </div>

                        <div class="flex items-center gap-6 shrink-0">
                            <div class="text-right">
                                <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">
                                    Total
                                </p>
                                <p class="text-2xl font-semibold text-slate-900"
                                   th:text="${programareList.size()}">
                                    0
                                </p>
                                <p class="text-xs text-slate-500">
                                    Programări
                                </p>
                            </div>

                            <div class="flex gap-2">
                                <a th:href="@{/programare}"
                                   class="inline-flex items-center gap-2
                                  rounded-md bg-slate-900 px-4 py-2
                                  text-sm font-semibold text-white
                                  hover:bg-slate-800">
                                    Programează
                                </a>

                                <a th:href="@{/contact}"
                                   class="inline-flex items-center gap-2
                                  rounded-md border border-slate-300
                                  bg-white px-4 py-2
                                  text-sm font-semibold text-slate-700
                                  hover:bg-slate-50">
                                    Contact
                                </a>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="px-6 py-4 bg-slate-50">
                    <div class="flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between">

                        <div class="flex flex-col gap-2 sm:flex-row sm:items-center">

                            <div class="relative w-full sm:w-[320px]">
                                <svg class="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"
                                     viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="11" cy="11" r="7"/>
                                    <path d="M21 21l-4.3-4.3"/>
                                </svg>
                                <input type="text"
                                       placeholder="Caută după client, mașină, document..."
                                       class="w-full rounded-md border border-slate-300
                                      bg-white py-2 pl-9 pr-3
                                      text-sm text-slate-900
                                      placeholder:text-slate-400
                                      focus:border-slate-400 focus:outline-none"/>
                            </div>

                            <div class="flex flex-wrap gap-2">
                                <button class="rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-100">
                                    Toate
                                </button>
                                <button class="rounded-md border border-emerald-300 bg-emerald-100 px-3 py-2 text-sm font-semibold text-emerald-800">
                                    Confirmate
                                </button>
                                <button class="rounded-md border border-amber-300 bg-amber-100 px-3 py-2 text-sm font-semibold text-amber-900">
                                    În așteptare
                                </button>
                                <button class="rounded-md border border-rose-300 bg-rose-100 px-3 py-2 text-sm font-semibold text-rose-800">
                                    Anulate
                                </button>
                            </div>
                        </div>

                        <div class="flex items-center gap-2">
                            <span class="text-xs font-semibold text-slate-500">Sortare:</span>
                            <button class="rounded-md border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-100">
                                Dată (crescător)
                            </button>
                        </div>

                    </div>
                </div>

            </div>

            <!-- alerte -->
            <div th:replace="~{fragments/succes-message}"></div>
            <div th:replace="~{fragments/notification-error}"></div>

        </header>


        <div class="mt-8 px-4 sm:px-6 lg:px-10">
        <div th:each="programare : ${programareList}"
             class="grid
            grid-cols-[110px_minmax(0,1.5fr)_minmax(0,1.5fr)_minmax(0,1fr)_140px_160px]
            items-start gap-4
            border-b border-slate-200 py-4
            hover:bg-slate-50 transition">

            <div class="text-right whitespace-nowrap">
                <p class="text-xs text-slate-500"
                   th:text="${#temporals.format(programare.dataProgramare, 'dd MMM yyyy')}"></p>
                <p class="text-sm font-semibold text-slate-900"
                   th:text="|${#numbers.formatInteger(programare.oraProgramare,2)}:${#numbers.formatInteger(programare.minutProgramare,2)}|"></p>
            </div>

            <div class="min-w-0">
                <p class="text-xs text-slate-500">Client</p>
                <p class="font-semibold text-slate-900 truncate"
                   th:text="${programare.getNume()}"></p>
            </div>

            <div class="min-w-0">
                <p class="text-xs text-slate-500">Mașină</p>
                <p class="text-sm text-slate-800 truncate">
                    <span th:text="${programare.marca?.nume}"></span>
                    <span th:text="${programare.modelAuto?.numeModel}"></span>
                </p>
            </div>

            <div class="min-w-0">
                <p class="text-xs text-slate-500">Document</p>
                <p th:if="${programare.fileStorage != null}"
                   class="text-sm text-slate-700 truncate"
                   th:title="${programare.fileStorage.fileOriginalName}"
                   th:text="${programare.fileStorage.fileOriginalName}"></p>
                <p th:unless="${programare.fileStorage != null}"
                   class="text-sm italic text-slate-400 whitespace-nowrap">
                    Fără document
                </p>
            </div>

            <div class="flex justify-start">
                <span class="inline-flex items-center gap-1 px-2.5 py-1
                             text-xs font-semibold rounded-full border"
                      th:classappend="
                          ${programare.isConfirmed() == true} ? 'bg-emerald-100 text-emerald-800 border-emerald-300' :
                          (${programare.isCanceled() == true} ? 'bg-rose-100 text-rose-800 border-rose-300' :
                          'bg-amber-100 text-amber-900 border-amber-300')">

                    <span class="h-1.5 w-1.5 rounded-full"
                          th:classappend="
                              ${programare.isConfirmed() == true} ? 'bg-emerald-600' :
                              (${programare.isCanceled() == true} ? 'bg-rose-600' : 'bg-amber-600')">
                    </span>

                    <span th:text="
                          ${programare.isConfirmed() == true} ? 'Confirmată' :
                          (${programare.isCanceled() == true} ? 'Anulată' : 'În așteptare')">
                    </span>
                </span>
            </div>


            <div class="flex gap-2 justify-end whitespace-nowrap">
                <a th:if="${programare.fileStorage != null}"
                   th:href="@{|/files/${programare.fileStorage.id}|}"
                   class="px-3 py-1.5 text-[11px] font-semibold uppercase
                  rounded-md border border-slate-300
                  text-slate-700 hover:bg-slate-100 transition">
                    Descarcă
                </a>

                <button th:if="${!programare.canceled}"
                        th:attr="onclick=|openModal('cancelModal-${programare.id}')|"
                        class="px-3 py-1.5 text-[11px] font-semibold uppercase
                       rounded-md bg-red-600 text-white
                       hover:bg-red-700 transition">
                    Anulează
                </button>
            </div>

            <div th:replace="~{fragments/anulare-programare :: anulare-programare(${programare.id})}"></div>
        </div>
    </div>
</section>
</body>
</html>
